# Client API (version 1) <br/> Passwords Microservices Client SDK for Node.js

Node.js client API for Passwords microservice is a thin layer on the top of
communication protocols. It hides details related to specific protocol implementation
and provides high-level API to access the microservice for simple and productive development.

* [Installation](#install)
* [Getting started](#get_started)
* [IPasswordsClientV1 interface](#interface)
    - [setPassword()](#operation1)
    - [deletePassword()](#operation2)
    - [authenticate()](#operation3)
    - [changePassword()](#operation4)
    - [resetPassword()](#operation5)
    - [recoverPassword()](#operation6)
* [PasswordsHttpClientV1 class](#client_rest)
* [PasswordsSenecaClientV1 class](#client_seneca)
* [PasswordsDirectClientV1 class](#client_direct)
* [PasswordsNullClientV1 class](#client_null)

## <a name="install"></a> Installation

To work with the client SDK add dependency into package.json file:

```javascript
{
    ...
    "dependencies": {
        ....
        "client-passwords-node": "^1.0.*",
        ...
    }
}
```

Then download the dependency using **npm**:

```javascript
# Installing dependencies
npm install

# Updating dependencies
npm update
```

## <a name="get_started"></a> Getting started

This is a simple example on how to work with the microservice using REST client:

```javascript
// Get Client SDK for Version 1 
let sdk = new require('client-passwords-node');

// Client configuration
let config = {
    connection: {
        protocol: 'http',
        host: 'localhost', 
        port: 8080
    }
};

// Create the client instance
let client = sdk.PasswordsHttpClientV1(config);

// Open client connection to the microservice
await client.open(null);

console.log('Opened connection');
        
// Set password for a new user
await client.setPassword('123', 'test123');

// Authenticate user
let autnenticated = await client.authenticate('123','test123');

console.log('Authentication result is');
console.log(authentication);
                    
// Close connection
await client.close(null); 
```

## <a name="interface"></a> IPasswordsClientV1 interface

If you are using Typescript, you can use IPasswordsClient as a common interface across all client implementations. 
If you are using plain Javascript, you shall not worry about IPasswordsClient interface. You can just expect that
all methods defined in this interface are implemented by all client classes.

```javascript
interface IPasswordsClientV1 {
    setPassword(correlationId, userId, password);
    deletePassword(correlationId, userId);
    authenticate(correlationId, userId, password);
    changePassword(correlationId, userId, oldPassword, newPassword);
    resetPassword(correlationId, userId, code, password);
    recoverPassword(correlationId, userId);
}
```

### <a name="operation1"></a> setPassword(correlationId, userId, password)

Sets password for a new user in the system and creates an object for him.

**Arguments:** 
- correlationId: string - id that uniquely identifies transaction
- userId: string - unique user id generated by the client
- password: string - user password
 
### <a name="operation2"></a> deletePassword(correlationId, userId)

Deletes user password from the system (use it carefully!)

**Arguments:** 
- correlationId: string - id that uniquely identifies transaction
- userId: string - unique user id

### <a name="operation3"></a> authenticate(correlationId, userId, password)

Authenticates user using ID/password combination and returns user object.

**Arguments:** 
- correlationId: string - id that uniquely identifies transaction
- userId: string - unique user id to identify the user
- password: string - user password
- returns: boolean - True when authentication was successful
 
### <a name="operation4"></a> changePassword(correlationId, userId, oldPassword, newPassword)

Changes user password by providing old password

**Arguments:** 
- correlationId: string - id that uniquely identifies transaction
- userId: string - unique user id to identify the user
- oldPassword: string - old user password
- newPassword: string - new user password

### <a name="operation5"></a> resetPassword(correlationId, userId, code, password)

Resets user password by providing recovery code

**Arguments:** 
- correlationId: string - id that uniquely identifies transaction
- userId: string - unique user id to identify the user
- code: string - password recovery code
- password: string - new user password

### <a name="operation6"></a> recoverPassword(correlationId, userId)

Generates password recovery code for the user and sends it via email

**Arguments:** 
- correlationId: string - id that uniquely identifies transaction
- userId: string - unique user id to identify the user

## <a name="client_rest"></a> PasswordsHttpClientV1 class

PasswordsHttpClient is a client that implements HTTP protocol

```javascript
class PasswordsHttpClientV1 extends CommandableHttpClient implements IPasswordsClient {
    constructor(config: any);
    setReferences(references);
    open(correlationId);
    close(correlationId);
    setPassword(correlationId, userId, password);
    deletePassword(correlationId, userId);
    authenticate(correlationId, userId, password);
    changePassword(correlationId, userId, oldPassword, newPassword);
    resetPassword(correlationId, userId, code, password);
    recoverPassword(correlationId, userId);
}
```

**Constructor config properties:** 
- connection: object - HTTP transport configuration options
  - protocol: string - HTTP protocol - 'http' or 'https' (default is 'http')
  - host: string - IP address/hostname binding (default is '0.0.0.0')
  - port: number - HTTP port number

## <a name="client_seneca"></a> PasswordsSenecaClientV1 class

PasswordsSenecaClientV1 is a client that implements Seneca protocol

```javascript
class PasswordsSenecaClientV1 extends CommandableSenecaClient implements IPasswordsClientV1 {
    constructor(config: any);        
    setReferences(references);
    open(correlationId);
    close(correlationId);
    setPassword(correlationId, userId, password);
    deletePassword(correlationId, userId);
    authenticate(correlationId, userId, password);
    changePassword(correlationId, userId, oldPassword, newPassword);
    resetPassword(correlationId, userId, code, password);
    recoverPassword(correlationId, userId);
}
```

**Constructor config properties:** 
- connection: object - (optional) Seneca transport configuration options. See http://senecajs.org/api/ for details.
  - protocol: string - Seneca transport type 
  - host: string - IP address/hostname binding (default is '0.0.0.0')
  - port: number - Seneca port number

## <a name="client_direct"></a> PasswordsDirectClientV1 class

PasswordsDirectClientV1 is a null client for testing. It never fails and always returns a fake UserPassword object

```javascript
class PasswordsDirectClientV1 extends DirectClient implements IPasswordsClientV1 {
    constructor(config: any);        
    setReferences(references);
    open(correlationId);
    close(correlationId);
    setPassword(correlationId, userId, password);
    deletePassword(correlationId, userId);
    authenticate(correlationId, userId, password);
    changePassword(correlationId, userId, oldPassword, newPassword);
    resetPassword(correlationId, userId, code, password);
    recoverPassword(correlationId, userId);
```

## <a name="client_null"></a> PasswordsNullClientV1 class

PasswordsNullClientV1 is a null client for testing. It never fails and always returns a fake UserPassword object

```javascript
class PasswordsNullClientV1 implements IPasswordsClientV1 {
    setPassword(correlationId, userId, password);
    deletePassword(correlationId, userId);
    authenticate(correlationId, userId, password);
    changePassword(correlationId, userId, oldPassword, newPassword);
    resetPassword(correlationId, userId, code, password);
    recoverPassword(correlationId, userId);
```
